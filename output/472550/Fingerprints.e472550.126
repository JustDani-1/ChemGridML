Found local copy...
Loading...
Done!
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[12:54:01] WARNING: not removing hydrogen atom without neighbors
[I 2025-09-08 12:54:07,525] A new study created in RDB with name: ECFP_SVM_BBB_Martins_6
[I 2025-09-08 12:54:07,535] A new study created in RDB with name: ECFP_SVM_BBB_Martins_8
[I 2025-09-08 12:54:07,600] A new study created in RDB with name: ECFP_SVM_BBB_Martins_9
[I 2025-09-08 12:54:08,800] A new study created in RDB with name: ECFP_SVM_BBB_Martins_7
[I 2025-09-08 12:54:54,982] Trial 0 finished with value: 0.5490991473197937 and parameters: {'C': 0.00889406822214728, 'kernel': 'sigmoid'}. Best is trial 0 with value: 0.5490991473197937.
[I 2025-09-08 12:54:56,601] Trial 0 finished with value: 0.552645742893219 and parameters: {'C': 0.04380371265462969, 'kernel': 'sigmoid'}. Best is trial 0 with value: 0.552645742893219.
[I 2025-09-08 12:55:10,213] Trial 0 finished with value: 0.5148192048072815 and parameters: {'C': 0.17531949412819325, 'kernel': 'rbf'}. Best is trial 0 with value: 0.5148192048072815.
[I 2025-09-08 12:55:21,352] Trial 0 finished with value: 0.5117265582084656 and parameters: {'C': 0.12462523031113697, 'kernel': 'poly'}. Best is trial 0 with value: 0.5117265582084656.
[I 2025-09-08 12:55:34,863] Trial 1 finished with value: 0.48184293508529663 and parameters: {'C': 0.8066474632310393, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.48184293508529663.
[I 2025-09-08 12:55:43,498] Trial 1 finished with value: 0.5296112895011902 and parameters: {'C': 0.06373771859178934, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.5296112895011902.
[I 2025-09-08 12:56:21,936] Trial 1 finished with value: 0.4851212799549103 and parameters: {'C': 0.5085966649038166, 'kernel': 'poly'}. Best is trial 1 with value: 0.4851212799549103.
[I 2025-09-08 12:56:21,991] Trial 1 finished with value: 0.5095834136009216 and parameters: {'C': 0.21011232445827524, 'kernel': 'rbf'}. Best is trial 1 with value: 0.5095834136009216.
[I 2025-09-08 12:56:48,358] Trial 2 finished with value: 0.49219056963920593 and parameters: {'C': 0.4310710547094415, 'kernel': 'poly'}. Best is trial 1 with value: 0.48184293508529663.
[I 2025-09-08 12:56:55,792] Trial 2 finished with value: 0.49300238490104675 and parameters: {'C': 0.6465727833345596, 'kernel': 'poly'}. Best is trial 2 with value: 0.49300238490104675.
[I 2025-09-08 12:57:07,860] Trial 2 finished with value: 0.5490991473197937 and parameters: {'C': 0.0031139662118189987, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.5095834136009216.
[I 2025-09-08 12:57:20,880] Trial 2 finished with value: 0.5357345938682556 and parameters: {'C': 0.11797250771319535, 'kernel': 'rbf'}. Best is trial 1 with value: 0.4851212799549103.
[I 2025-09-08 12:57:27,432] Trial 3 finished with value: 0.4812098443508148 and parameters: {'C': 2.6869237866302815, 'kernel': 'sigmoid'}. Best is trial 3 with value: 0.4812098443508148.
[I 2025-09-08 12:57:43,113] Trial 3 finished with value: 0.4802189767360687 and parameters: {'C': 7.7113986269282275, 'kernel': 'sigmoid'}. Best is trial 3 with value: 0.4802189767360687.
[I 2025-09-08 12:57:43,887] Trial 3 finished with value: 0.5527936816215515 and parameters: {'C': 0.03611686408036947, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.49300238490104675.
[I 2025-09-08 12:57:59,810] Trial 3 finished with value: 0.47043576836586 and parameters: {'C': 1.242378456258158, 'kernel': 'sigmoid'}. Best is trial 3 with value: 0.47043576836586.
[I 2025-09-08 12:58:29,684] Trial 4 finished with value: 0.5527936816215515 and parameters: {'C': 0.0025192752775497025, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.49300238490104675.
[I 2025-09-08 12:58:36,009] Trial 4 finished with value: 0.5490991473197937 and parameters: {'C': 0.01556223358714623, 'kernel': 'poly'}. Best is trial 3 with value: 0.4812098443508148.
[I 2025-09-08 12:58:48,931] Trial 4 finished with value: 0.5460202693939209 and parameters: {'C': 0.001036354833712994, 'kernel': 'poly'}. Best is trial 3 with value: 0.47043576836586.
[I 2025-09-08 12:58:49,039] Trial 4 finished with value: 0.5466601252555847 and parameters: {'C': 0.03799200870021825, 'kernel': 'poly'}. Best is trial 3 with value: 0.4802189767360687.
[I 2025-09-08 12:59:14,765] Trial 5 finished with value: 0.5527936816215515 and parameters: {'C': 0.0017087982151416806, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.49300238490104675.
[I 2025-09-08 12:59:43,889] Trial 5 finished with value: 0.5490991473197937 and parameters: {'C': 0.018902294605018133, 'kernel': 'poly'}. Best is trial 3 with value: 0.4812098443508148.
[I 2025-09-08 12:59:49,288] Trial 5 finished with value: 0.5268042683601379 and parameters: {'C': 0.1401355475006722, 'kernel': 'rbf'}. Best is trial 3 with value: 0.47043576836586.
[I 2025-09-08 13:00:01,146] Trial 6 finished with value: 0.5527936816215515 and parameters: {'C': 0.0042870357882099, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.49300238490104675.
[I 2025-09-08 13:00:10,804] Trial 5 finished with value: 0.46245133876800537 and parameters: {'C': 6.142342165661855, 'kernel': 'rbf'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:00:35,923] Trial 6 finished with value: 0.5452566146850586 and parameters: {'C': 0.04157292045006981, 'kernel': 'sigmoid'}. Best is trial 3 with value: 0.47043576836586.
[I 2025-09-08 13:00:54,221] Trial 6 finished with value: 0.4815470576286316 and parameters: {'C': 1.8498361429436103, 'kernel': 'poly'}. Best is trial 3 with value: 0.4812098443508148.
[I 2025-09-08 13:01:22,984] Trial 7 finished with value: 0.4655782878398895 and parameters: {'C': 6.7892837212486885, 'kernel': 'rbf'}. Best is trial 7 with value: 0.4655782878398895.
[I 2025-09-08 13:01:28,457] Trial 6 finished with value: 0.4632529318332672 and parameters: {'C': 2.723889409193331, 'kernel': 'rbf'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:01:35,499] Trial 7 finished with value: 0.5460202693939209 and parameters: {'C': 0.005573039438002696, 'kernel': 'rbf'}. Best is trial 3 with value: 0.47043576836586.
[I 2025-09-08 13:02:03,535] Trial 7 finished with value: 0.5406366586685181 and parameters: {'C': 0.05601383336492268, 'kernel': 'poly'}. Best is trial 3 with value: 0.4812098443508148.
[I 2025-09-08 13:02:11,956] Trial 8 finished with value: 0.5527936816215515 and parameters: {'C': 0.0011228666036429294, 'kernel': 'poly'}. Best is trial 7 with value: 0.4655782878398895.
[I 2025-09-08 13:02:21,297] Trial 8 finished with value: 0.5460202693939209 and parameters: {'C': 0.0034808641946973886, 'kernel': 'sigmoid'}. Best is trial 3 with value: 0.47043576836586.
[I 2025-09-08 13:02:25,807] Trial 7 finished with value: 0.5490991473197937 and parameters: {'C': 0.006599288934801722, 'kernel': 'rbf'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:02:50,508] Trial 8 finished with value: 0.5490991473197937 and parameters: {'C': 0.0010488773396000305, 'kernel': 'poly'}. Best is trial 3 with value: 0.4812098443508148.
[I 2025-09-08 13:03:23,244] Trial 9 finished with value: 0.5011449456214905 and parameters: {'C': 0.30608332744054173, 'kernel': 'poly'}. Best is trial 7 with value: 0.4655782878398895.
[I 2025-09-08 13:03:37,117] Trial 8 finished with value: 0.4765452444553375 and parameters: {'C': 4.034400008213124, 'kernel': 'poly'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:03:39,070] Trial 9 finished with value: 0.4578211307525635 and parameters: {'C': 5.77021179377432, 'kernel': 'rbf'}. Best is trial 9 with value: 0.4578211307525635.
[I 2025-09-08 13:03:51,938] Trial 9 finished with value: 0.5490991473197937 and parameters: {'C': 0.004056697064912639, 'kernel': 'poly'}. Best is trial 3 with value: 0.4812098443508148.
[I 2025-09-08 13:04:38,364] Trial 9 finished with value: 0.504853367805481 and parameters: {'C': 0.2340129989687025, 'kernel': 'rbf'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:04:42,045] Trial 10 finished with value: 0.4655782878398895 and parameters: {'C': 7.065094721654155, 'kernel': 'rbf'}. Best is trial 7 with value: 0.4655782878398895.
[I 2025-09-08 13:04:57,292] Trial 10 finished with value: 0.45867082476615906 and parameters: {'C': 8.477497780878721, 'kernel': 'rbf'}. Best is trial 9 with value: 0.4578211307525635.
[I 2025-09-08 13:05:13,404] Trial 10 finished with value: 0.46415072679519653 and parameters: {'C': 8.742624050876028, 'kernel': 'rbf'}. Best is trial 10 with value: 0.46415072679519653.
[I 2025-09-08 13:05:38,916] Trial 10 finished with value: 0.47596731781959534 and parameters: {'C': 0.6492011467576753, 'kernel': 'rbf'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:06:00,264] Trial 11 finished with value: 0.46504849195480347 and parameters: {'C': 7.9027767787542995, 'kernel': 'rbf'}. Best is trial 11 with value: 0.46504849195480347.
[I 2025-09-08 13:06:17,324] Trial 11 finished with value: 0.45952048897743225 and parameters: {'C': 9.694119249513065, 'kernel': 'rbf'}. Best is trial 9 with value: 0.4578211307525635.
[I 2025-09-08 13:06:33,963] Trial 11 finished with value: 0.46415072679519653 and parameters: {'C': 9.63791680042119, 'kernel': 'rbf'}. Best is trial 10 with value: 0.46415072679519653.
[I 2025-09-08 13:06:55,131] Trial 11 finished with value: 0.46290889382362366 and parameters: {'C': 1.6673089701413513, 'kernel': 'rbf'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:07:19,390] Trial 12 finished with value: 0.46504849195480347 and parameters: {'C': 9.085714390980936, 'kernel': 'rbf'}. Best is trial 11 with value: 0.46504849195480347.
[I 2025-09-08 13:07:36,905] Trial 12 finished with value: 0.45952048897743225 and parameters: {'C': 9.188718764625214, 'kernel': 'rbf'}. Best is trial 9 with value: 0.4578211307525635.
[I 2025-09-08 13:07:54,529] Trial 12 finished with value: 0.46227937936782837 and parameters: {'C': 5.655793328037807, 'kernel': 'rbf'}. Best is trial 12 with value: 0.46227937936782837.
[I 2025-09-08 13:07:58,501] Trial 12 finished with value: 0.46911823749542236 and parameters: {'C': 0.9265309749162876, 'kernel': 'rbf'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:08:36,189] Trial 13 finished with value: 0.4643365144729614 and parameters: {'C': 1.853933914341072, 'kernel': 'rbf'}. Best is trial 13 with value: 0.4643365144729614.
[I 2025-09-08 13:08:54,643] Trial 13 finished with value: 0.4559016525745392 and parameters: {'C': 2.009202375265954, 'kernel': 'rbf'}. Best is trial 13 with value: 0.4559016525745392.
[I 2025-09-08 13:09:13,765] Trial 13 finished with value: 0.4631187617778778 and parameters: {'C': 1.4628504698682963, 'kernel': 'rbf'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:09:14,117] Trial 13 finished with value: 0.463534951210022 and parameters: {'C': 8.132836370283231, 'kernel': 'rbf'}. Best is trial 12 with value: 0.46227937936782837.
[I 2025-09-08 13:09:49,875] Trial 14 finished with value: 0.48081064224243164 and parameters: {'C': 8.170415333178443, 'kernel': 'sigmoid'}. Best is trial 5 with value: 0.46245133876800537.
[I 2025-09-08 13:09:52,760] Trial 14 finished with value: 0.4661356210708618 and parameters: {'C': 1.467742927010278, 'kernel': 'rbf'}. Best is trial 13 with value: 0.4643365144729614.
[I 2025-09-08 13:10:10,601] Trial 14 finished with value: 0.4572569727897644 and parameters: {'C': 1.6820218507751468, 'kernel': 'rbf'}. Best is trial 13 with value: 0.4559016525745392.
[I 2025-09-08 13:10:15,114] Trial 14 finished with value: 0.5151631236076355 and parameters: {'C': 0.23489080139671134, 'kernel': 'rbf'}. Best is trial 12 with value: 0.46227937936782837.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
