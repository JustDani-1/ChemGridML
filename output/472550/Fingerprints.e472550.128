Found local copy...
Loading...
Done!
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[12:54:02] WARNING: not removing hydrogen atom without neighbors
[I 2025-09-08 12:54:09,533] A new study created in RDB with name: MACCS_SVM_BBB_Martins_7
[I 2025-09-08 12:54:09,542] A new study created in RDB with name: MACCS_SVM_BBB_Martins_3
[I 2025-09-08 12:54:09,555] A new study created in RDB with name: MACCS_SVM_BBB_Martins_8
[I 2025-09-08 12:54:09,596] A new study created in RDB with name: MACCS_SVM_BBB_Martins_9
[I 2025-09-08 12:54:18,926] Trial 0 finished with value: 0.5416479706764221 and parameters: {'C': 0.06449705824246223, 'kernel': 'sigmoid'}. Best is trial 0 with value: 0.5416479706764221.
[I 2025-09-08 12:54:18,936] Trial 0 finished with value: 0.49856480956077576 and parameters: {'C': 0.7237188959089533, 'kernel': 'sigmoid'}. Best is trial 0 with value: 0.49856480956077576.
[I 2025-09-08 12:54:18,951] Trial 0 finished with value: 0.5413384437561035 and parameters: {'C': 0.07008764978166544, 'kernel': 'sigmoid'}. Best is trial 0 with value: 0.5413384437561035.
[I 2025-09-08 12:54:19,599] Trial 0 finished with value: 0.5444929599761963 and parameters: {'C': 0.04393308038838239, 'kernel': 'rbf'}. Best is trial 0 with value: 0.5444929599761963.
[I 2025-09-08 12:54:24,782] Trial 1 finished with value: 0.4760671555995941 and parameters: {'C': 0.452411960686788, 'kernel': 'poly'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:54:26,008] Trial 1 finished with value: 0.5253933668136597 and parameters: {'C': 2.36829132992121, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.5253933668136597.
[I 2025-09-08 12:54:27,237] Trial 1 finished with value: 0.48609134554862976 and parameters: {'C': 0.3149642749499606, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.48609134554862976.
[I 2025-09-08 12:54:29,072] Trial 1 finished with value: 0.5397250056266785 and parameters: {'C': 0.05077887970344061, 'kernel': 'rbf'}. Best is trial 0 with value: 0.49856480956077576.
[I 2025-09-08 12:54:33,965] Trial 2 finished with value: 0.5435572266578674 and parameters: {'C': 0.009447469742736208, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:54:34,092] Trial 2 finished with value: 0.48817604780197144 and parameters: {'C': 0.07804269750003993, 'kernel': 'poly'}. Best is trial 1 with value: 0.48609134554862976.
[I 2025-09-08 12:54:36,939] Trial 2 finished with value: 0.5527936816215515 and parameters: {'C': 0.016406174638657005, 'kernel': 'rbf'}. Best is trial 1 with value: 0.5253933668136597.
[I 2025-09-08 12:54:38,389] Trial 2 finished with value: 0.4821387231349945 and parameters: {'C': 0.48963724974339734, 'kernel': 'rbf'}. Best is trial 2 with value: 0.4821387231349945.
[I 2025-09-08 12:54:42,653] Trial 3 finished with value: 0.5460202693939209 and parameters: {'C': 0.009682674472994564, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.48609134554862976.
[I 2025-09-08 12:54:42,802] Trial 3 finished with value: 0.5435572266578674 and parameters: {'C': 0.005703233672600602, 'kernel': 'rbf'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:54:46,881] Trial 3 finished with value: 0.48848217725753784 and parameters: {'C': 0.16954734763022544, 'kernel': 'rbf'}. Best is trial 3 with value: 0.48848217725753784.
[I 2025-09-08 12:54:47,355] Trial 3 finished with value: 0.5460443496704102 and parameters: {'C': 0.06327030944242074, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.4821387231349945.
[I 2025-09-08 12:54:47,670] Trial 4 finished with value: 0.5460202693939209 and parameters: {'C': 0.008428668576084484, 'kernel': 'poly'}. Best is trial 1 with value: 0.48609134554862976.
[I 2025-09-08 12:54:49,440] Trial 4 finished with value: 0.528496265411377 and parameters: {'C': 4.047026668722977, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:54:55,540] Trial 4 finished with value: 0.5490991473197937 and parameters: {'C': 0.00790918451618952, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.4821387231349945.
[I 2025-09-08 12:54:55,988] Trial 4 finished with value: 0.4839860498905182 and parameters: {'C': 0.2753118546667909, 'kernel': 'rbf'}. Best is trial 4 with value: 0.4839860498905182.
[I 2025-09-08 12:54:57,162] Trial 5 finished with value: 0.5236015915870667 and parameters: {'C': 0.06251287646832697, 'kernel': 'rbf'}. Best is trial 1 with value: 0.48609134554862976.
[I 2025-09-08 12:55:00,031] Trial 5 finished with value: 0.5435572266578674 and parameters: {'C': 0.003135127308386051, 'kernel': 'sigmoid'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:55:04,456] Trial 5 finished with value: 0.5395529866218567 and parameters: {'C': 0.06893224019373435, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.4821387231349945.
[I 2025-09-08 12:55:04,997] Trial 5 finished with value: 0.5527936816215515 and parameters: {'C': 0.001843942984952417, 'kernel': 'rbf'}. Best is trial 4 with value: 0.4839860498905182.
[I 2025-09-08 12:55:07,267] Trial 6 finished with value: 0.4592486619949341 and parameters: {'C': 5.114735805722267, 'kernel': 'rbf'}. Best is trial 6 with value: 0.4592486619949341.
[I 2025-09-08 12:55:09,678] Trial 6 finished with value: 0.5435572266578674 and parameters: {'C': 0.0016898976011950142, 'kernel': 'rbf'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:55:14,621] Trial 6 finished with value: 0.5490991473197937 and parameters: {'C': 0.001377634824920904, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.4821387231349945.
[I 2025-09-08 12:55:15,061] Trial 6 finished with value: 0.5527936816215515 and parameters: {'C': 0.0021461163879596184, 'kernel': 'rbf'}. Best is trial 4 with value: 0.4839860498905182.
[I 2025-09-08 12:55:15,558] Trial 7 finished with value: 0.5060986876487732 and parameters: {'C': 0.033675922620290996, 'kernel': 'poly'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:55:17,604] Trial 7 finished with value: 0.48050129413604736 and parameters: {'C': 0.3125870122575008, 'kernel': 'rbf'}. Best is trial 6 with value: 0.4592486619949341.
[I 2025-09-08 12:55:21,526] Trial 8 finished with value: 0.5435572266578674 and parameters: {'C': 0.006539773624391398, 'kernel': 'poly'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:55:21,864] Trial 7 finished with value: 0.4903879165649414 and parameters: {'C': 0.45643637225334305, 'kernel': 'sigmoid'}. Best is trial 2 with value: 0.4821387231349945.
[I 2025-09-08 12:55:22,062] Trial 7 finished with value: 0.4940824508666992 and parameters: {'C': 0.41372935585708176, 'kernel': 'sigmoid'}. Best is trial 4 with value: 0.4839860498905182.
[I 2025-09-08 12:55:27,606] Trial 8 finished with value: 0.5127620697021484 and parameters: {'C': 0.10699802434159505, 'kernel': 'sigmoid'}. Best is trial 6 with value: 0.4592486619949341.
[I 2025-09-08 12:55:30,650] Trial 8 finished with value: 0.4796997606754303 and parameters: {'C': 0.6467087486735106, 'kernel': 'rbf'}. Best is trial 8 with value: 0.4796997606754303.
[I 2025-09-08 12:55:30,661] Trial 9 finished with value: 0.4874742925167084 and parameters: {'C': 0.17163528235011696, 'kernel': 'rbf'}. Best is trial 1 with value: 0.4760671555995941.
[I 2025-09-08 12:55:32,899] Trial 8 finished with value: 0.5527936816215515 and parameters: {'C': 0.008664452134316762, 'kernel': 'rbf'}. Best is trial 4 with value: 0.4839860498905182.
[I 2025-09-08 12:55:37,079] Trial 10 finished with value: 0.46409234404563904 and parameters: {'C': 1.1534789510141534, 'kernel': 'poly'}. Best is trial 10 with value: 0.46409234404563904.
[I 2025-09-08 12:55:37,874] Trial 9 finished with value: 0.45865699648857117 and parameters: {'C': 6.307197548513617, 'kernel': 'rbf'}. Best is trial 9 with value: 0.45865699648857117.
[I 2025-09-08 12:55:39,483] Trial 9 finished with value: 0.46294325590133667 and parameters: {'C': 4.359720893909897, 'kernel': 'rbf'}. Best is trial 9 with value: 0.46294325590133667.
[I 2025-09-08 12:55:42,355] Trial 9 finished with value: 0.5527936816215515 and parameters: {'C': 0.047286968508108415, 'kernel': 'sigmoid'}. Best is trial 4 with value: 0.4839860498905182.
[I 2025-09-08 12:55:43,179] Trial 11 finished with value: 0.46676525473594666 and parameters: {'C': 1.0089456173860454, 'kernel': 'poly'}. Best is trial 10 with value: 0.46409234404563904.
[I 2025-09-08 12:55:46,497] Trial 10 finished with value: 0.46946898102760315 and parameters: {'C': 8.487937044652073, 'kernel': 'poly'}. Best is trial 9 with value: 0.46294325590133667.
[I 2025-09-08 12:55:48,043] Trial 10 finished with value: 0.45952045917510986 and parameters: {'C': 3.710864530651293, 'kernel': 'rbf'}. Best is trial 9 with value: 0.45865699648857117.
[I 2025-09-08 12:55:49,073] Trial 12 finished with value: 0.46322882175445557 and parameters: {'C': 1.9773447868092984, 'kernel': 'poly'}. Best is trial 12 with value: 0.46322882175445557.
[I 2025-09-08 12:55:49,128] Trial 10 finished with value: 0.47157418727874756 and parameters: {'C': 8.122013761355177, 'kernel': 'poly'}. Best is trial 10 with value: 0.47157418727874756.
[I 2025-09-08 12:55:55,220] Trial 11 finished with value: 0.4690011441707611 and parameters: {'C': 7.708872210414849, 'kernel': 'poly'}. Best is trial 9 with value: 0.46294325590133667.
[I 2025-09-08 12:55:55,537] Trial 13 finished with value: 0.46211764216423035 and parameters: {'C': 7.188456313920747, 'kernel': 'poly'}. Best is trial 13 with value: 0.46211764216423035.
[I 2025-09-08 12:55:57,147] Trial 11 finished with value: 0.4691730737686157 and parameters: {'C': 6.570124266408346, 'kernel': 'poly'}. Best is trial 11 with value: 0.4691730737686157.
[I 2025-09-08 12:55:58,878] Trial 11 finished with value: 0.45774537324905396 and parameters: {'C': 7.174246978941016, 'kernel': 'rbf'}. Best is trial 11 with value: 0.45774537324905396.
[I 2025-09-08 12:56:00,930] Trial 12 finished with value: 0.4698508083820343 and parameters: {'C': 7.960862003958377, 'kernel': 'poly'}. Best is trial 9 with value: 0.46294325590133667.
[I 2025-09-08 12:56:01,195] Trial 14 finished with value: 0.46217960119247437 and parameters: {'C': 5.031139502978431, 'kernel': 'poly'}. Best is trial 13 with value: 0.46211764216423035.
[I 2025-09-08 12:56:04,026] Trial 12 finished with value: 0.4722759425640106 and parameters: {'C': 8.974189958188035, 'kernel': 'poly'}. Best is trial 11 with value: 0.4691730737686157.
[I 2025-09-08 12:56:06,635] Trial 13 finished with value: 0.46975451707839966 and parameters: {'C': 3.153511047232945, 'kernel': 'poly'}. Best is trial 9 with value: 0.46294325590133667.
[I 2025-09-08 12:56:07,013] Trial 12 finished with value: 0.46553370356559753 and parameters: {'C': 1.459106481604558, 'kernel': 'rbf'}. Best is trial 11 with value: 0.45774537324905396.
[I 2025-09-08 12:56:08,140] Trial 13 finished with value: 0.47157418727874756 and parameters: {'C': 8.441372656585104, 'kernel': 'poly'}. Best is trial 11 with value: 0.4691730737686157.
[I 2025-09-08 12:56:13,709] Trial 14 finished with value: 0.4650760889053345 and parameters: {'C': 2.1104547897316874, 'kernel': 'rbf'}. Best is trial 9 with value: 0.46294325590133667.
[I 2025-09-08 12:56:13,714] Trial 14 finished with value: 0.47739487886428833 and parameters: {'C': 0.7376027915540312, 'kernel': 'poly'}. Best is trial 11 with value: 0.4691730737686157.
[I 2025-09-08 12:56:14,687] Trial 13 finished with value: 0.4562799334526062 and parameters: {'C': 9.593856321665822, 'kernel': 'rbf'}. Best is trial 13 with value: 0.4562799334526062.
[I 2025-09-08 12:56:17,312] Trial 14 finished with value: 0.46653130650520325 and parameters: {'C': 1.4383634684075348, 'kernel': 'rbf'}. Best is trial 13 with value: 0.4562799334526062.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
