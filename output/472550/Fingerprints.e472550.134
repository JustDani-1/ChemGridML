Found local copy...
Loading...
Done!
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[I 2025-09-08 13:31:54,678] A new study created in RDB with name: MACCS_ElasticNet_BBB_Martins_7
[I 2025-09-08 13:31:54,701] A new study created in RDB with name: MACCS_ElasticNet_BBB_Martins_5
[I 2025-09-08 13:31:54,723] A new study created in RDB with name: MACCS_ElasticNet_BBB_Martins_8
[I 2025-09-08 13:31:54,795] A new study created in RDB with name: MACCS_ElasticNet_BBB_Martins_9
[I 2025-09-08 13:32:32,803] Trial 0 finished with value: 0.4770336449146271 and parameters: {'alpha': 4.469598729458001, 'l1_ratio': 0.2665515947309278}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:32:40,314] Trial 0 finished with value: 0.48241376876831055 and parameters: {'alpha': 2.951734821684634, 'l1_ratio': 0.4594389916013645}. Best is trial 0 with value: 0.48241376876831055.
[I 2025-09-08 13:32:59,689] Trial 0 finished with value: 0.47636619210243225 and parameters: {'alpha': 1.0184655690837974, 'l1_ratio': 0.4047550653890585}. Best is trial 0 with value: 0.47636619210243225.
[I 2025-09-08 13:33:01,976] Trial 0 finished with value: 0.4850728511810303 and parameters: {'alpha': 0.001515080370619504, 'l1_ratio': 0.5903152259962402}. Best is trial 0 with value: 0.4850728511810303.
[I 2025-09-08 13:33:33,669] Trial 1 finished with value: 0.47782137989997864 and parameters: {'alpha': 2.0398136466449444, 'l1_ratio': 0.7900805812397805}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:33:49,795] Trial 1 finished with value: 0.48199406266212463 and parameters: {'alpha': 0.09303253774855917, 'l1_ratio': 0.1640772678528909}. Best is trial 1 with value: 0.48199406266212463.
[I 2025-09-08 13:34:08,313] Trial 1 finished with value: 0.4791732132434845 and parameters: {'alpha': 0.10726677073785108, 'l1_ratio': 0.5038641412810106}. Best is trial 0 with value: 0.47636619210243225.
[I 2025-09-08 13:34:10,902] Trial 1 finished with value: 0.4852207601070404 and parameters: {'alpha': 0.04500777279014594, 'l1_ratio': 0.4003572723770594}. Best is trial 0 with value: 0.4850728511810303.
[I 2025-09-08 13:34:38,530] Trial 2 finished with value: 0.4743606448173523 and parameters: {'alpha': 3.4045568870637077, 'l1_ratio': 0.7842025605703596}. Best is trial 2 with value: 0.4743606448173523.
[I 2025-09-08 13:34:43,294] Trial 2 finished with value: 0.4820319414138794 and parameters: {'alpha': 0.4141198123524334, 'l1_ratio': 0.45539564419090295}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:34:51,102] Trial 2 finished with value: 0.4809482991695404 and parameters: {'alpha': 1.7456733555035922, 'l1_ratio': 0.5596331343903198}. Best is trial 2 with value: 0.4809482991695404.
[I 2025-09-08 13:35:19,593] Trial 2 finished with value: 0.4850728511810303 and parameters: {'alpha': 0.0039481878901036814, 'l1_ratio': 0.8387526513467489}. Best is trial 0 with value: 0.4850728511810303.
[I 2025-09-08 13:35:46,079] Trial 3 finished with value: 0.4791732132434845 and parameters: {'alpha': 0.01027751623070517, 'l1_ratio': 0.15393177521101525}. Best is trial 2 with value: 0.4743606448173523.
[I 2025-09-08 13:35:54,164] Trial 3 finished with value: 0.48197001218795776 and parameters: {'alpha': 0.003600874051430899, 'l1_ratio': 0.2401297857242396}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:35:58,218] Trial 3 finished with value: 0.48307767510414124 and parameters: {'alpha': 0.004142950248110011, 'l1_ratio': 0.43728557882569163}. Best is trial 2 with value: 0.4809482991695404.
[I 2025-09-08 13:36:27,461] Trial 3 finished with value: 0.4841371774673462 and parameters: {'alpha': 0.20745985644823103, 'l1_ratio': 0.1871539637106345}. Best is trial 3 with value: 0.4841371774673462.
[I 2025-09-08 13:36:54,676] Trial 4 finished with value: 0.4789392948150635 and parameters: {'alpha': 0.07356299743400291, 'l1_ratio': 0.6031824431921097}. Best is trial 2 with value: 0.4743606448173523.
[I 2025-09-08 13:36:59,372] Trial 4 finished with value: 0.48115822672843933 and parameters: {'alpha': 1.8572901502503345, 'l1_ratio': 0.2363515802984015}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:37:06,430] Trial 4 finished with value: 0.4805905520915985 and parameters: {'alpha': 0.9242021865584161, 'l1_ratio': 0.3731471406881969}. Best is trial 4 with value: 0.4805905520915985.
[I 2025-09-08 13:37:34,939] Trial 4 finished with value: 0.48082447052001953 and parameters: {'alpha': 0.8658713857965826, 'l1_ratio': 0.6092628052924709}. Best is trial 4 with value: 0.48082447052001953.
[I 2025-09-08 13:38:01,593] Trial 5 finished with value: 0.47847145795822144 and parameters: {'alpha': 0.38322498660403775, 'l1_ratio': 0.2926237782660732}. Best is trial 2 with value: 0.4743606448173523.
[I 2025-09-08 13:38:11,788] Trial 5 finished with value: 0.48197001218795776 and parameters: {'alpha': 0.0021943039166472393, 'l1_ratio': 0.1685043223585443}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:38:16,074] Trial 5 finished with value: 0.47997480630874634 and parameters: {'alpha': 0.6152940332326174, 'l1_ratio': 0.49467494988998595}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:38:25,353] Trial 6 finished with value: 0.4742746949195862 and parameters: {'alpha': 4.53791579392045, 'l1_ratio': 0.606147325116292}. Best is trial 6 with value: 0.4742746949195862.
[I 2025-09-08 13:38:46,081] Trial 5 finished with value: 0.4852207601070404 and parameters: {'alpha': 0.05675716567429777, 'l1_ratio': 0.10058993976637201}. Best is trial 4 with value: 0.48082447052001953.
[I 2025-09-08 13:39:20,976] Trial 6 finished with value: 0.48197001218795776 and parameters: {'alpha': 0.012737181256717758, 'l1_ratio': 0.3304576943861671}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:39:24,054] Trial 6 finished with value: 0.48307767510414124 and parameters: {'alpha': 0.0011239634659420657, 'l1_ratio': 0.23920575781790074}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:39:32,539] Trial 7 finished with value: 0.4789392948150635 and parameters: {'alpha': 0.31721409120296423, 'l1_ratio': 0.31166330817162613}. Best is trial 6 with value: 0.4742746949195862.
[I 2025-09-08 13:39:56,559] Trial 6 finished with value: 0.4850728511810303 and parameters: {'alpha': 0.0010331473070740488, 'l1_ratio': 0.3815040097703487}. Best is trial 4 with value: 0.48082447052001953.
[I 2025-09-08 13:40:31,861] Trial 7 finished with value: 0.48188403248786926 and parameters: {'alpha': 0.3087975355135004, 'l1_ratio': 0.19097132461370914}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:40:33,486] Trial 7 finished with value: 0.4822898805141449 and parameters: {'alpha': 0.30362866055105253, 'l1_ratio': 0.25058498382453276}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:40:43,253] Trial 8 finished with value: 0.4791732132434845 and parameters: {'alpha': 0.00132167196540726, 'l1_ratio': 0.5286453542972301}. Best is trial 6 with value: 0.4742746949195862.
[I 2025-09-08 13:41:05,206] Trial 7 finished with value: 0.4816741645336151 and parameters: {'alpha': 0.6931802000402424, 'l1_ratio': 0.3863102617918073}. Best is trial 4 with value: 0.48082447052001953.
[I 2025-09-08 13:41:20,973] Trial 8 finished with value: 0.4774395525455475 and parameters: {'alpha': 2.9095047795404905, 'l1_ratio': 0.5469002209917095}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:41:35,136] Trial 8 finished with value: 0.4824618995189667 and parameters: {'alpha': 0.024638162277834264, 'l1_ratio': 0.8524204647634139}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:41:41,788] Trial 9 finished with value: 0.4782375395298004 and parameters: {'alpha': 0.5181174074719944, 'l1_ratio': 0.5005542589469983}. Best is trial 6 with value: 0.4742746949195862.
[I 2025-09-08 13:41:42,295] Trial 8 finished with value: 0.4793349504470825 and parameters: {'alpha': 2.6530750429954737, 'l1_ratio': 0.6927455542076161}. Best is trial 8 with value: 0.4793349504470825.
[I 2025-09-08 13:41:56,374] Trial 10 finished with value: 0.48109978437423706 and parameters: {'alpha': 6.558552791397929, 'l1_ratio': 0.8847841152078759}. Best is trial 6 with value: 0.4742746949195862.
[I 2025-09-08 13:42:10,209] Trial 11 finished with value: 0.48154354095458984 and parameters: {'alpha': 9.325070555266214, 'l1_ratio': 0.741396953257224}. Best is trial 6 with value: 0.4742746949195862.
[I 2025-09-08 13:42:12,427] Trial 9 finished with value: 0.4821179509162903 and parameters: {'alpha': 0.16969717045106109, 'l1_ratio': 0.7152353979508279}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:42:13,329] Trial 9 finished with value: 0.479420930147171 and parameters: {'alpha': 3.349497064122354, 'l1_ratio': 0.1599731304784541}. Best is trial 8 with value: 0.4793349504470825.
[I 2025-09-08 13:42:25,529] Trial 9 finished with value: 0.4822898805141449 and parameters: {'alpha': 0.29477281235367914, 'l1_ratio': 0.3453742726798262}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:42:38,096] Trial 10 finished with value: 0.4855201840400696 and parameters: {'alpha': 7.544788957975116, 'l1_ratio': 0.8279262228534625}. Best is trial 8 with value: 0.4793349504470825.
[I 2025-09-08 13:42:42,021] Trial 12 finished with value: 0.4743606448173523 and parameters: {'alpha': 2.6751524823602093, 'l1_ratio': 0.7084219563481036}. Best is trial 6 with value: 0.4742746949195862.
[I 2025-09-08 13:42:49,418] Trial 10 finished with value: 0.48401686549186707 and parameters: {'alpha': 9.761610827829795, 'l1_ratio': 0.6375029515390092}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:43:01,710] Trial 11 finished with value: 0.4847564995288849 and parameters: {'alpha': 7.986757237922672, 'l1_ratio': 0.6882411168769791}. Best is trial 8 with value: 0.4793349504470825.
[I 2025-09-08 13:43:04,821] Trial 10 finished with value: 0.48197001218795776 and parameters: {'alpha': 0.032805684808529946, 'l1_ratio': 0.43229430960571436}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:43:19,255] Trial 13 finished with value: 0.4738308787345886 and parameters: {'alpha': 1.966997300999179, 'l1_ratio': 0.8816864817381432}. Best is trial 13 with value: 0.4738308787345886.
[I 2025-09-08 13:43:24,362] Trial 11 finished with value: 0.4814196825027466 and parameters: {'alpha': 9.920763574624766, 'l1_ratio': 0.6153366985732553}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:43:39,329] Trial 11 finished with value: 0.4802706241607666 and parameters: {'alpha': 1.067710045910823, 'l1_ratio': 0.6574554365155587}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:43:41,829] Trial 12 finished with value: 0.47942447662353516 and parameters: {'alpha': 7.999191950058648, 'l1_ratio': 0.5865023665345397}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:43:45,182] Trial 12 finished with value: 0.48097240924835205 and parameters: {'alpha': 1.6962451836920585, 'l1_ratio': 0.27823761091073707}. Best is trial 8 with value: 0.4793349504470825.
[I 2025-09-08 13:43:55,159] Trial 14 finished with value: 0.4738308787345886 and parameters: {'alpha': 2.029464873051599, 'l1_ratio': 0.8553889886929671}. Best is trial 13 with value: 0.4738308787345886.
[I 2025-09-08 13:44:20,277] Trial 13 finished with value: 0.47956886887550354 and parameters: {'alpha': 2.518991737769448, 'l1_ratio': 0.7107862999342149}. Best is trial 8 with value: 0.4793349504470825.
[I 2025-09-08 13:44:23,163] Trial 13 finished with value: 0.480136513710022 and parameters: {'alpha': 1.9367530760563714, 'l1_ratio': 0.39894714945163723}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:44:23,665] Trial 12 finished with value: 0.48222798109054565 and parameters: {'alpha': 0.06287023484848903, 'l1_ratio': 0.688145558639882}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:44:59,874] Trial 14 finished with value: 0.48352140188217163 and parameters: {'alpha': 0.20617353331687788, 'l1_ratio': 0.5040176076325801}. Best is trial 8 with value: 0.4793349504470825.
[I 2025-09-08 13:45:03,003] Trial 14 finished with value: 0.4818599820137024 and parameters: {'alpha': 0.6060507513311842, 'l1_ratio': 0.8827816036523717}. Best is trial 0 with value: 0.4770336449146271.
[I 2025-09-08 13:45:03,894] Trial 13 finished with value: 0.47997480630874634 and parameters: {'alpha': 0.6893513686346296, 'l1_ratio': 0.7810459501979369}. Best is trial 5 with value: 0.47997480630874634.
[I 2025-09-08 13:45:20,439] Trial 14 finished with value: 0.48082447052001953 and parameters: {'alpha': 0.31547783627600806, 'l1_ratio': 0.8695534295164176}. Best is trial 5 with value: 0.47997480630874634.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
