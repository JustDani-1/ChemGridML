Found local copy...
Loading...
Done!
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[I 2025-09-08 13:31:53,891] A new study created in RDB with name: TOPOTOR_ElasticNet_BBB_Martins_4
[I 2025-09-08 13:31:54,064] A new study created in RDB with name: TOPOTOR_ElasticNet_BBB_Martins_7
[I 2025-09-08 13:31:54,082] A new study created in RDB with name: TOPOTOR_ElasticNet_BBB_Martins_9
[I 2025-09-08 13:31:54,625] A new study created in RDB with name: TOPOTOR_ElasticNet_BBB_Martins_8
[I 2025-09-08 13:37:52,716] Trial 0 finished with value: 0.4671538174152374 and parameters: {'alpha': 2.56907916992672, 'l1_ratio': 0.6870943385557277}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 13:38:11,216] Trial 0 finished with value: 0.48255816102027893 and parameters: {'alpha': 0.3293173054253353, 'l1_ratio': 0.5948977348615834}. Best is trial 0 with value: 0.48255816102027893.
[I 2025-09-08 13:38:37,298] Trial 0 finished with value: 0.4887019991874695 and parameters: {'alpha': 0.023782127299614115, 'l1_ratio': 0.17551425497806702}. Best is trial 0 with value: 0.4887019991874695.
[I 2025-09-08 13:38:37,514] Trial 0 finished with value: 0.4727540910243988 and parameters: {'alpha': 0.025477289491335514, 'l1_ratio': 0.4349802871493106}. Best is trial 0 with value: 0.4727540910243988.
[I 2025-09-08 13:43:58,359] Trial 1 finished with value: 0.4700847268104553 and parameters: {'alpha': 4.96423385319705, 'l1_ratio': 0.17835454496309683}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 13:44:39,832] Trial 1 finished with value: 0.4744569659233093 and parameters: {'alpha': 9.601741222250228, 'l1_ratio': 0.25275875118287905}. Best is trial 0 with value: 0.4727540910243988.
[I 2025-09-08 13:45:00,491] Trial 1 finished with value: 0.48287805914878845 and parameters: {'alpha': 0.016006301854160535, 'l1_ratio': 0.3141248831045964}. Best is trial 0 with value: 0.48255816102027893.
[I 2025-09-08 13:45:11,135] Trial 1 finished with value: 0.48846808075904846 and parameters: {'alpha': 0.06035897120118763, 'l1_ratio': 0.4164178528148995}. Best is trial 1 with value: 0.48846808075904846.
[I 2025-09-08 13:50:46,969] Trial 2 finished with value: 0.4745394289493561 and parameters: {'alpha': 0.024389019695369493, 'l1_ratio': 0.2474264522553738}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 13:50:56,604] Trial 2 finished with value: 0.4722622036933899 and parameters: {'alpha': 0.43535454323720996, 'l1_ratio': 0.3972650770499777}. Best is trial 2 with value: 0.4722622036933899.
[I 2025-09-08 13:51:00,859] Trial 2 finished with value: 0.4810824394226074 and parameters: {'alpha': 2.183664274213485, 'l1_ratio': 0.4587769946587702}. Best is trial 2 with value: 0.4810824394226074.
[I 2025-09-08 13:51:15,961] Trial 2 finished with value: 0.4880140423774719 and parameters: {'alpha': 3.777576399321501, 'l1_ratio': 0.10279306052586473}. Best is trial 2 with value: 0.4880140423774719.
[I 2025-09-08 13:57:12,859] Trial 3 finished with value: 0.48615649342536926 and parameters: {'alpha': 8.872512828582432, 'l1_ratio': 0.29347557332941554}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 13:57:29,293] Trial 3 finished with value: 0.4745394289493561 and parameters: {'alpha': 0.03906121720929631, 'l1_ratio': 0.6048261507625131}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 13:57:37,576] Trial 3 finished with value: 0.4725201725959778 and parameters: {'alpha': 0.04413736220326543, 'l1_ratio': 0.3550919333034438}. Best is trial 2 with value: 0.4722622036933899.
[I 2025-09-08 13:57:53,494] Trial 3 finished with value: 0.48273012042045593 and parameters: {'alpha': 0.001903686370931029, 'l1_ratio': 0.3356178525974949}. Best is trial 2 with value: 0.4810824394226074.
[I 2025-09-08 14:03:32,314] Trial 4 finished with value: 0.4745086431503296 and parameters: {'alpha': 6.927657654437898, 'l1_ratio': 0.778713219042094}. Best is trial 2 with value: 0.4722622036933899.
[I 2025-09-08 14:03:39,084] Trial 4 finished with value: 0.4735797047615051 and parameters: {'alpha': 0.39804319408426636, 'l1_ratio': 0.8977395960709615}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:03:39,581] Trial 4 finished with value: 0.48800021409988403 and parameters: {'alpha': 0.3149522939296109, 'l1_ratio': 0.1491146521505498}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:03:53,972] Trial 4 finished with value: 0.48038068413734436 and parameters: {'alpha': 1.795177056241539, 'l1_ratio': 0.8772589740605714}. Best is trial 4 with value: 0.48038068413734436.
[I 2025-09-08 14:10:15,822] Trial 5 finished with value: 0.4727540910243988 and parameters: {'alpha': 0.016832790177293565, 'l1_ratio': 0.8403899412678105}. Best is trial 2 with value: 0.4722622036933899.
[I 2025-09-08 14:10:16,027] Trial 5 finished with value: 0.4887019991874695 and parameters: {'alpha': 0.029301699699338185, 'l1_ratio': 0.6050503354111152}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:10:25,891] Trial 5 finished with value: 0.4745394289493561 and parameters: {'alpha': 0.02593135997525519, 'l1_ratio': 0.43041127187077877}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:10:47,228] Trial 5 finished with value: 0.4824962019920349 and parameters: {'alpha': 0.012751650268600664, 'l1_ratio': 0.10879877383809361}. Best is trial 4 with value: 0.48038068413734436.
[I 2025-09-08 14:16:29,333] Trial 6 finished with value: 0.4738515019416809 and parameters: {'alpha': 1.4019207650264902, 'l1_ratio': 0.39544788208387305}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:16:30,956] Trial 6 finished with value: 0.48814818263053894 and parameters: {'alpha': 0.1720444781677647, 'l1_ratio': 0.7703519040380451}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:16:53,914] Trial 6 finished with value: 0.4725201725959778 and parameters: {'alpha': 0.06543170602163682, 'l1_ratio': 0.39105914112053264}. Best is trial 2 with value: 0.4722622036933899.
[I 2025-09-08 14:17:38,954] Trial 6 finished with value: 0.4824962019920349 and parameters: {'alpha': 0.0024372375704868874, 'l1_ratio': 0.887067800300262}. Best is trial 4 with value: 0.48038068413734436.
[I 2025-09-08 14:22:35,823] Trial 7 finished with value: 0.47381362318992615 and parameters: {'alpha': 0.3696834778254264, 'l1_ratio': 0.8647449887565403}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:23:14,584] Trial 7 finished with value: 0.4889359176158905 and parameters: {'alpha': 0.002570854341791331, 'l1_ratio': 0.49070531914828974}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:23:44,384] Trial 7 finished with value: 0.47322192788124084 and parameters: {'alpha': 0.003431812331122443, 'l1_ratio': 0.40676920618433454}. Best is trial 2 with value: 0.4722622036933899.
[I 2025-09-08 14:24:32,020] Trial 7 finished with value: 0.48273012042045593 and parameters: {'alpha': 0.0029304115647079644, 'l1_ratio': 0.197368946784166}. Best is trial 4 with value: 0.48038068413734436.
[I 2025-09-08 14:29:26,438] Trial 8 finished with value: 0.4745394289493561 and parameters: {'alpha': 0.003002344229749944, 'l1_ratio': 0.8096829661721443}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:29:57,194] Trial 8 finished with value: 0.4887019991874695 and parameters: {'alpha': 0.008809217552211097, 'l1_ratio': 0.3723056550888113}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:30:13,648] Trial 8 finished with value: 0.4724341630935669 and parameters: {'alpha': 0.11360006375429092, 'l1_ratio': 0.5861369161883846}. Best is trial 2 with value: 0.4722622036933899.
[I 2025-09-08 14:31:23,182] Trial 8 finished with value: 0.48273012042045593 and parameters: {'alpha': 0.002688701371802971, 'l1_ratio': 0.556323226068689}. Best is trial 4 with value: 0.48038068413734436.
[I 2025-09-08 14:35:45,755] Trial 9 finished with value: 0.47474929690361023 and parameters: {'alpha': 0.43130886143529756, 'l1_ratio': 0.39447594656044804}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:35:54,182] Trial 9 finished with value: 0.4883958697319031 and parameters: {'alpha': 1.3983408494928329, 'l1_ratio': 0.615512858987944}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:36:14,579] Trial 9 finished with value: 0.47216591238975525 and parameters: {'alpha': 4.461301460447898, 'l1_ratio': 0.5200199514618523}. Best is trial 9 with value: 0.47216591238975525.
[I 2025-09-08 14:37:28,936] Trial 9 finished with value: 0.48206627368927 and parameters: {'alpha': 1.1678030088027056, 'l1_ratio': 0.40865493483706217}. Best is trial 4 with value: 0.48038068413734436.
[I 2025-09-08 14:41:38,524] Trial 10 finished with value: 0.4686467945575714 and parameters: {'alpha': 9.213602356856713, 'l1_ratio': 0.6422491948934894}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:41:53,539] Trial 10 finished with value: 0.48618054389953613 and parameters: {'alpha': 6.771814622378196, 'l1_ratio': 0.30195454832968954}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:42:16,327] Trial 10 finished with value: 0.4723241329193115 and parameters: {'alpha': 1.2103702029240433, 'l1_ratio': 0.6306157262288283}. Best is trial 9 with value: 0.47216591238975525.
[I 2025-09-08 14:43:08,248] Trial 10 finished with value: 0.4774671196937561 and parameters: {'alpha': 9.863599313254538, 'l1_ratio': 0.8947291842124871}. Best is trial 10 with value: 0.4774671196937561.
[I 2025-09-08 14:47:36,080] Trial 11 finished with value: 0.4688188433647156 and parameters: {'alpha': 7.5952785606013915, 'l1_ratio': 0.6553821225783635}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:47:53,536] Trial 11 finished with value: 0.48668625950813293 and parameters: {'alpha': 9.615934841624632, 'l1_ratio': 0.2891634582886363}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:48:42,515] Trial 11 finished with value: 0.4712645709514618 and parameters: {'alpha': 0.7612810025586901, 'l1_ratio': 0.11092285183502304}. Best is trial 11 with value: 0.4712645709514618.
[I 2025-09-08 14:48:50,874] Trial 11 finished with value: 0.4778730273246765 and parameters: {'alpha': 9.207452722296832, 'l1_ratio': 0.8557714439835418}. Best is trial 10 with value: 0.4774671196937561.
[I 2025-09-08 14:53:34,879] Trial 12 finished with value: 0.47049063444137573 and parameters: {'alpha': 1.7901824186060458, 'l1_ratio': 0.6811727986322229}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 14:54:06,638] Trial 12 finished with value: 0.48697853088378906 and parameters: {'alpha': 0.77128603790936, 'l1_ratio': 0.25791874764287726}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 14:54:41,664] Trial 12 finished with value: 0.4788946807384491 and parameters: {'alpha': 8.739985668530629, 'l1_ratio': 0.7189966632185006}. Best is trial 10 with value: 0.4774671196937561.
[I 2025-09-08 14:55:02,859] Trial 12 finished with value: 0.472176194190979 and parameters: {'alpha': 1.2091294392702072, 'l1_ratio': 0.10809212228894151}. Best is trial 11 with value: 0.4712645709514618.
[I 2025-09-08 14:59:29,450] Trial 13 finished with value: 0.46811702847480774 and parameters: {'alpha': 9.680121587307493, 'l1_ratio': 0.5739398613568053}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 15:00:04,229] Trial 13 finished with value: 0.48641446232795715 and parameters: {'alpha': 6.682998312779903, 'l1_ratio': 0.3130688094761521}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 15:00:33,272] Trial 13 finished with value: 0.47760123014450073 and parameters: {'alpha': 8.162063415698288, 'l1_ratio': 0.7480204333487508}. Best is trial 10 with value: 0.4774671196937561.
[I 2025-09-08 15:01:13,879] Trial 13 finished with value: 0.4723241329193115 and parameters: {'alpha': 1.8366942748818407, 'l1_ratio': 0.14235966462294986}. Best is trial 11 with value: 0.4712645709514618.
[I 2025-09-08 15:05:31,046] Trial 14 finished with value: 0.47049063444137573 and parameters: {'alpha': 1.9275404689841897, 'l1_ratio': 0.5439566807825453}. Best is trial 0 with value: 0.4671538174152374.
[I 2025-09-08 15:06:02,672] Trial 14 finished with value: 0.48816195130348206 and parameters: {'alpha': 1.7935874431093515, 'l1_ratio': 0.4642188243477841}. Best is trial 3 with value: 0.48615649342536926.
[I 2025-09-08 15:06:59,831] Trial 14 finished with value: 0.4829399883747101 and parameters: {'alpha': 0.15883795254492133, 'l1_ratio': 0.7237905393917923}. Best is trial 10 with value: 0.4774671196937561.
[I 2025-09-08 15:07:23,868] Trial 14 finished with value: 0.4724961221218109 and parameters: {'alpha': 0.303979611310647, 'l1_ratio': 0.5803151787379537}. Best is trial 11 with value: 0.4712645709514618.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
