Found local copy...
Loading...
Done!
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[13:31:48] WARNING: not removing hydrogen atom without neighbors
[I 2025-09-08 13:31:53,369] A new study created in RDB with name: MOL2VEC_ElasticNet_BBB_Martins_6
[I 2025-09-08 13:31:53,400] A new study created in RDB with name: MOL2VEC_ElasticNet_BBB_Martins_7
[I 2025-09-08 13:31:53,418] A new study created in RDB with name: MOL2VEC_ElasticNet_BBB_Martins_8
[I 2025-09-08 13:31:53,742] A new study created in RDB with name: MOL2VEC_ElasticNet_BBB_Martins_9
[I 2025-09-08 13:34:18,802] Trial 0 finished with value: 0.47739142179489136 and parameters: {'alpha': 1.8286021990023749, 'l1_ratio': 0.6199275970730835}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:34:19,315] Trial 0 finished with value: 0.47792115807533264 and parameters: {'alpha': 1.7018245255571616, 'l1_ratio': 0.45865464504540643}. Best is trial 0 with value: 0.47792115807533264.
[I 2025-09-08 13:34:25,512] Trial 0 finished with value: 0.4735970199108124 and parameters: {'alpha': 0.14074209830373516, 'l1_ratio': 0.3587458703201676}. Best is trial 0 with value: 0.4735970199108124.
[I 2025-09-08 13:34:29,098] Trial 0 finished with value: 0.46979236602783203 and parameters: {'alpha': 0.024135952389997023, 'l1_ratio': 0.17976284044619142}. Best is trial 0 with value: 0.46979236602783203.
[I 2025-09-08 13:36:52,043] Trial 1 finished with value: 0.4783511459827423 and parameters: {'alpha': 0.021798821205888035, 'l1_ratio': 0.4722994362486287}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:36:53,748] Trial 1 finished with value: 0.47135764360427856 and parameters: {'alpha': 1.4870217840390971, 'l1_ratio': 0.8832968263571266}. Best is trial 0 with value: 0.46979236602783203.
[I 2025-09-08 13:36:53,871] Trial 1 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.011683469765507198, 'l1_ratio': 0.6358099621404416}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:37:00,550] Trial 1 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.13656825449534815, 'l1_ratio': 0.11021001735219951}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:39:23,667] Trial 2 finished with value: 0.47625964879989624 and parameters: {'alpha': 2.2525455756041497, 'l1_ratio': 0.8985905938481413}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:39:25,467] Trial 2 finished with value: 0.46970638632774353 and parameters: {'alpha': 0.08619735866582037, 'l1_ratio': 0.6082333980527431}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:39:27,610] Trial 2 finished with value: 0.4783511459827423 and parameters: {'alpha': 0.0013372405847204756, 'l1_ratio': 0.15230309596466887}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:39:27,753] Trial 2 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.007169954744244143, 'l1_ratio': 0.6435593732262095}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:41:48,016] Trial 3 finished with value: 0.47215917706489563 and parameters: {'alpha': 4.577498816486113, 'l1_ratio': 0.6134752563776315}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:41:59,863] Trial 3 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.006685846086041609, 'l1_ratio': 0.10093978636968962}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:42:01,749] Trial 3 finished with value: 0.4783511459827423 and parameters: {'alpha': 0.013461040691598713, 'l1_ratio': 0.3897963241786361}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:42:04,192] Trial 3 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.0033630937507573267, 'l1_ratio': 0.6607325886278604}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:44:22,499] Trial 4 finished with value: 0.46979236602783203 and parameters: {'alpha': 0.06300241638363163, 'l1_ratio': 0.33173683179730395}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:44:25,203] Trial 4 finished with value: 0.4814438223838806 and parameters: {'alpha': 2.1929826614357655, 'l1_ratio': 0.8309516304663691}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:44:34,099] Trial 4 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.022381802358728407, 'l1_ratio': 0.7752099641256085}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:44:39,150] Trial 4 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.0023848893889763167, 'l1_ratio': 0.4277235915379549}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:46:54,218] Trial 5 finished with value: 0.4703221917152405 and parameters: {'alpha': 0.16004123054799405, 'l1_ratio': 0.4772579316432828}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:47:00,310] Trial 5 finished with value: 0.4783511459827423 and parameters: {'alpha': 0.00924281225504646, 'l1_ratio': 0.5284219591914153}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:47:10,189] Trial 5 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.0031485582577364325, 'l1_ratio': 0.48613395019179995}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:47:10,808] Trial 5 finished with value: 0.4771815240383148 and parameters: {'alpha': 0.26031684660193416, 'l1_ratio': 0.2267122369995785}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:49:23,651] Trial 6 finished with value: 0.4703840911388397 and parameters: {'alpha': 1.010437946193177, 'l1_ratio': 0.2489437359893777}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:49:28,649] Trial 6 finished with value: 0.4782651662826538 and parameters: {'alpha': 0.4367073120524107, 'l1_ratio': 0.576457304089281}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:49:45,500] Trial 6 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.009647441439251746, 'l1_ratio': 0.15129963605509458}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:49:45,529] Trial 6 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.012871128079179407, 'l1_ratio': 0.8310449896519899}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:51:54,433] Trial 7 finished with value: 0.4703221917152405 and parameters: {'alpha': 0.27642614424451933, 'l1_ratio': 0.4397697721064242}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:51:56,202] Trial 7 finished with value: 0.47832703590393066 and parameters: {'alpha': 2.09693258374576, 'l1_ratio': 0.2328491004155252}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:52:06,747] Trial 7 finished with value: 0.4801400601863861 and parameters: {'alpha': 7.670882025109834, 'l1_ratio': 0.5320073447111336}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:52:21,078] Trial 7 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.0022151661092038905, 'l1_ratio': 0.35922485944390947}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:54:18,642] Trial 8 finished with value: 0.47112372517585754 and parameters: {'alpha': 2.3958890955800243, 'l1_ratio': 0.49596952070778577}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:54:26,497] Trial 8 finished with value: 0.4793487787246704 and parameters: {'alpha': 0.1857391807834535, 'l1_ratio': 0.4421473016785289}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:54:40,200] Trial 8 finished with value: 0.4771815240383148 and parameters: {'alpha': 0.05771333556657299, 'l1_ratio': 0.7119827944470253}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:54:57,857] Trial 8 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.0015644141272580022, 'l1_ratio': 0.3530806814817373}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:56:53,181] Trial 9 finished with value: 0.46979236602783203 and parameters: {'alpha': 0.02595931774087585, 'l1_ratio': 0.5301617978737309}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:57:02,498] Trial 9 finished with value: 0.4783511459827423 and parameters: {'alpha': 0.0023904866817081854, 'l1_ratio': 0.5447471931395229}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:57:08,253] Trial 9 finished with value: 0.47824108600616455 and parameters: {'alpha': 0.35440015614115117, 'l1_ratio': 0.8328377257576619}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 13:57:34,273] Trial 9 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.01628878625487305, 'l1_ratio': 0.4946853933305908}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 13:59:23,106] Trial 10 finished with value: 0.4798063039779663 and parameters: {'alpha': 4.1477180846873845, 'l1_ratio': 0.7765990147566413}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 13:59:27,651] Trial 10 finished with value: 0.46979236602783203 and parameters: {'alpha': 0.0026924550872939666, 'l1_ratio': 0.7517267294550504}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 13:59:43,806] Trial 10 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.03963418658956265, 'l1_ratio': 0.12146778899452626}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 14:00:02,752] Trial 10 finished with value: 0.47489047050476074 and parameters: {'alpha': 0.4314820486733832, 'l1_ratio': 0.6396779533586833}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 14:01:50,191] Trial 11 finished with value: 0.4782651662826538 and parameters: {'alpha': 0.3817509175777744, 'l1_ratio': 0.6776565170560604}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 14:02:02,941] Trial 11 finished with value: 0.46979236602783203 and parameters: {'alpha': 0.009946341737001133, 'l1_ratio': 0.14694607406084292}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 14:02:18,989] Trial 11 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.010418341181767581, 'l1_ratio': 0.6341454445735574}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 14:02:38,409] Trial 11 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.1079716350085178, 'l1_ratio': 0.10021052592125851}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 14:04:16,203] Trial 12 finished with value: 0.4786469638347626 and parameters: {'alpha': 0.59326202500057, 'l1_ratio': 0.6877031535207606}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 14:04:37,887] Trial 12 finished with value: 0.46979236602783203 and parameters: {'alpha': 0.008931334088075286, 'l1_ratio': 0.6706463863311682}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 14:04:53,764] Trial 12 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.010381400098184269, 'l1_ratio': 0.5626952508644794}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 14:05:08,635] Trial 12 finished with value: 0.4752722978591919 and parameters: {'alpha': 0.9701344679797489, 'l1_ratio': 0.21672761571055585}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 14:06:36,236] Trial 13 finished with value: 0.4806698262691498 and parameters: {'alpha': 9.022066814928746, 'l1_ratio': 0.6148232138730011}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 14:07:12,104] Trial 13 finished with value: 0.46979236602783203 and parameters: {'alpha': 0.04047528590626837, 'l1_ratio': 0.3170854475996025}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 14:07:30,750] Trial 13 finished with value: 0.47647976875305176 and parameters: {'alpha': 0.0011862734876262123, 'l1_ratio': 0.34713478595891534}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 14:07:43,821] Trial 13 finished with value: 0.47336310148239136 and parameters: {'alpha': 0.046760701241750934, 'l1_ratio': 0.23736444758910344}. Best is trial 1 with value: 0.47336310148239136.
[I 2025-09-08 14:09:10,910] Trial 14 finished with value: 0.4783511459827423 and parameters: {'alpha': 0.05364885813385087, 'l1_ratio': 0.35566919346526765}. Best is trial 0 with value: 0.47739142179489136.
[I 2025-09-08 14:09:45,373] Trial 14 finished with value: 0.46985429525375366 and parameters: {'alpha': 0.3877980121855337, 'l1_ratio': 0.10034877292809236}. Best is trial 2 with value: 0.46970638632774353.
[I 2025-09-08 14:10:01,345] Trial 14 finished with value: 0.4767136871814728 and parameters: {'alpha': 0.034785129114561164, 'l1_ratio': 0.743837737020096}. Best is trial 1 with value: 0.47647976875305176.
[I 2025-09-08 14:10:08,627] Trial 14 finished with value: 0.4735970199108124 and parameters: {'alpha': 0.3002808418250287, 'l1_ratio': 0.24030215179827535}. Best is trial 1 with value: 0.47336310148239136.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
