Found local copy...
Loading...
Done!
[I 2025-09-08 11:30:30,455] A new study created in RDB with name: ECFP_RF_Caco2_Wang_6
[I 2025-09-08 11:30:30,466] A new study created in RDB with name: ECFP_RF_Caco2_Wang_7
[I 2025-09-08 11:30:30,546] A new study created in RDB with name: ECFP_RF_Caco2_Wang_9
[I 2025-09-08 11:30:30,663] A new study created in RDB with name: ECFP_RF_Caco2_Wang_8
[I 2025-09-08 11:31:02,063] Trial 0 finished with value: 0.33959291591427615 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.33959291591427615.
[I 2025-09-08 11:31:02,132] Trial 0 finished with value: 0.27054030747116736 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.27054030747116736.
[I 2025-09-08 11:31:27,788] Trial 0 finished with value: 0.3436513799438247 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.3436513799438247.
[I 2025-09-08 11:31:39,466] Trial 1 finished with value: 0.3503908989168064 and parameters: {'n_estimators': 50, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.3436513799438247.
[I 2025-09-08 11:31:54,019] Trial 1 finished with value: 0.33847882670673796 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.33847882670673796.
[I 2025-09-08 11:31:54,315] Trial 0 finished with value: 0.2345229338970438 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.2345229338970438.
[I 2025-09-08 11:32:13,449] Trial 2 finished with value: 0.3387687591233824 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.33847882670673796.
[I 2025-09-08 11:33:03,620] Trial 1 finished with value: 0.22185740591153152 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:33:13,212] Trial 2 finished with value: 0.2564590147402784 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 2 with value: 0.2564590147402784.
[I 2025-09-08 11:33:28,642] Trial 1 finished with value: 0.24118261332387902 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.24118261332387902.
[I 2025-09-08 11:33:29,817] Trial 3 finished with value: 0.2663859673658512 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 2 with value: 0.2564590147402784.
[I 2025-09-08 11:33:39,476] Trial 2 finished with value: 0.3391593100055 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:33:43,383] Trial 2 finished with value: 0.27797016311418177 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.24118261332387902.
[I 2025-09-08 11:34:14,707] Trial 3 finished with value: 0.23892618310771754 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.23892618310771754.
[I 2025-09-08 11:34:25,086] Trial 3 finished with value: 0.24929288854146175 and parameters: {'n_estimators': 100, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.24118261332387902.
[I 2025-09-08 11:34:45,716] Trial 4 finished with value: 0.2594710169103707 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.24118261332387902.
[I 2025-09-08 11:34:58,764] Trial 3 finished with value: 0.23593915527770354 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:35:36,260] Trial 4 finished with value: 0.34187713120935365 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:35:36,830] Trial 4 finished with value: 0.2306423360255729 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.2306423360255729.
[I 2025-09-08 11:36:01,299] Trial 4 finished with value: 0.2464907995538122 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 3 with value: 0.23892618310771754.
[I 2025-09-08 11:36:01,354] Trial 5 finished with value: 0.23736071763253586 and parameters: {'n_estimators': 50, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:36:28,449] Trial 5 finished with value: 0.22698102336209575 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.22698102336209575.
[I 2025-09-08 11:36:53,297] Trial 6 finished with value: 0.23024049534237276 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:37:02,262] Trial 5 finished with value: 0.2486085641138482 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.24118261332387902.
[I 2025-09-08 11:37:06,460] Trial 5 finished with value: 0.23311306897734366 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:37:22,244] Trial 6 finished with value: 0.3569683112210932 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.24118261332387902.
[I 2025-09-08 11:38:17,983] Trial 6 finished with value: 0.24246908761255861 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 5 with value: 0.22698102336209575.
[I 2025-09-08 11:38:35,570] Trial 7 finished with value: 0.2675919273930568 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 5 with value: 0.22698102336209575.
[I 2025-09-08 11:38:42,409] Trial 6 finished with value: 0.2569994473951335 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:38:47,422] Trial 7 finished with value: 0.23477976188476807 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:38:57,411] Trial 8 finished with value: 0.2426171795700975 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.22698102336209575.
[I 2025-09-08 11:39:33,021] Trial 9 finished with value: 0.2500389934163544 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 5 with value: 0.22698102336209575.
[I 2025-09-08 11:39:34,095] Trial 7 finished with value: 0.23542147623290585 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.23542147623290585.
[I 2025-09-08 11:40:02,311] Trial 8 finished with value: 0.23996142459280462 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:40:05,077] Trial 7 finished with value: 0.2646929248042105 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:40:38,934] Trial 10 finished with value: 0.22561232087654226 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.22561232087654226.
[I 2025-09-08 11:40:55,575] Trial 8 finished with value: 0.23843179986552956 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:41:07,562] Trial 9 finished with value: 0.3435954240652175 and parameters: {'n_estimators': 50, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:41:07,775] Trial 8 finished with value: 0.26313340236671784 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.23542147623290585.
[I 2025-09-08 11:41:28,427] Trial 9 finished with value: 0.2564849620716097 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.23542147623290585.
[I 2025-09-08 11:41:46,089] Trial 11 finished with value: 0.22561232087654226 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.22561232087654226.
[I 2025-09-08 11:41:50,439] Trial 10 finished with value: 0.24279307769878103 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:42:19,839] Trial 9 finished with value: 0.23217296852734706 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:42:51,417] Trial 10 finished with value: 0.26019472812154104 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:42:58,373] Trial 11 finished with value: 0.23311306897734366 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:43:06,757] Trial 10 finished with value: 0.2376843353918666 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.23542147623290585.
[I 2025-09-08 11:43:42,483] Trial 11 finished with value: 0.23024049534237276 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:43:55,886] Trial 12 finished with value: 0.22457884283512414 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 12 with value: 0.22457884283512414.
[I 2025-09-08 11:44:04,722] Trial 12 finished with value: 0.23311306897734366 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:44:32,025] Trial 12 finished with value: 0.23024049534237276 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:44:44,446] Trial 11 finished with value: 0.2376843353918666 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.23542147623290585.
[I 2025-09-08 11:44:56,368] Trial 13 finished with value: 0.23475276591337804 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.23311306897734366.
[I 2025-09-08 11:45:02,121] Trial 13 finished with value: 0.26019472812154104 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:45:54,907] Trial 14 finished with value: 0.23024049534237276 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.22185740591153152.
[I 2025-09-08 11:46:06,462] Trial 13 finished with value: 0.22457884283512414 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 12 with value: 0.22457884283512414.
[I 2025-09-08 11:46:21,499] Trial 12 finished with value: 0.2376843353918666 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.23542147623290585.
[I 2025-09-08 11:46:55,377] Trial 14 finished with value: 0.23151369994900128 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 14 with value: 0.23151369994900128.
[I 2025-09-08 11:47:18,380] Trial 14 finished with value: 0.23427429994279161 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 12 with value: 0.22457884283512414.
[I 2025-09-08 11:47:32,833] Trial 13 finished with value: 0.2376843353918666 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.23542147623290585.
[I 2025-09-08 11:47:56,848] Trial 14 finished with value: 0.2376843353918666 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.23542147623290585.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
