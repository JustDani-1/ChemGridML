Found local copy...
Loading...
Done!
[I 2025-09-08 11:30:29,617] A new study created in RDB with name: AtomPair_RF_Caco2_Wang_6
[I 2025-09-08 11:30:29,634] A new study created in RDB with name: AtomPair_RF_Caco2_Wang_7
[I 2025-09-08 11:30:29,741] A new study created in RDB with name: AtomPair_RF_Caco2_Wang_9
[I 2025-09-08 11:30:29,779] A new study created in RDB with name: AtomPair_RF_Caco2_Wang_8
[I 2025-09-08 11:30:53,564] Trial 0 finished with value: 0.2668501199504067 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.2668501199504067.
[I 2025-09-08 11:31:28,453] Trial 0 finished with value: 0.23884071702557735 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.23884071702557735.
[I 2025-09-08 11:32:34,030] Trial 0 finished with value: 0.22835493525763212 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:32:36,495] Trial 0 finished with value: 0.23968117503076786 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.23968117503076786.
[I 2025-09-08 11:33:41,220] Trial 1 finished with value: 0.25472308171225594 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.25472308171225594.
[I 2025-09-08 11:33:57,169] Trial 1 finished with value: 0.2723872705155572 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:34:07,453] Trial 1 finished with value: 0.23550117651592942 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.23550117651592942.
[I 2025-09-08 11:34:30,272] Trial 1 finished with value: 0.23511049524916405 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:34:37,547] Trial 2 finished with value: 0.2544048035139291 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 2 with value: 0.2544048035139291.
[I 2025-09-08 11:34:52,541] Trial 2 finished with value: 0.27473775896467645 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:35:10,504] Trial 3 finished with value: 0.2561020534809009 and parameters: {'n_estimators': 50, 'max_depth': None, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 2 with value: 0.2544048035139291.
[I 2025-09-08 11:35:15,905] Trial 2 finished with value: 0.24053506573044586 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:35:42,551] Trial 2 finished with value: 0.23431045448961296 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 2 with value: 0.23431045448961296.
[I 2025-09-08 11:36:18,550] Trial 3 finished with value: 0.2692762769894617 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:36:40,732] Trial 4 finished with value: 0.262556189371028 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 2 with value: 0.2544048035139291.
[I 2025-09-08 11:37:14,879] Trial 3 finished with value: 0.23718593749080868 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 2 with value: 0.23431045448961296.
[I 2025-09-08 11:37:24,863] Trial 3 finished with value: 0.24629363483660419 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:37:42,740] Trial 4 finished with value: 0.2783733515060866 and parameters: {'n_estimators': 50, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:38:07,398] Trial 5 finished with value: 0.2556154308046321 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:38:32,314] Trial 4 finished with value: 0.2372460501615647 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:38:32,565] Trial 6 finished with value: 0.2517207862243148 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:38:47,960] Trial 5 finished with value: 0.2637971452584656 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 2 with value: 0.2544048035139291.
[I 2025-09-08 11:39:11,066] Trial 4 finished with value: 0.22699197045669842 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.22699197045669842.
[I 2025-09-08 11:39:20,940] Trial 7 finished with value: 0.24538092522449412 and parameters: {'n_estimators': 100, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:39:54,093] Trial 5 finished with value: 0.27218746371892283 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:40:24,950] Trial 6 finished with value: 0.27645274852703416 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:40:38,721] Trial 5 finished with value: 0.23788619945681005 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 4 with value: 0.22699197045669842.
[I 2025-09-08 11:41:00,798] Trial 6 finished with value: 0.26256518514059496 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 2 with value: 0.2544048035139291.
[I 2025-09-08 11:41:11,985] Trial 6 finished with value: 0.22653532092544607 and parameters: {'n_estimators': 50, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 6 with value: 0.22653532092544607.
[I 2025-09-08 11:42:21,477] Trial 8 finished with value: 0.23511049524916405 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:42:30,569] Trial 7 finished with value: 0.25210378642904135 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.25210378642904135.
[I 2025-09-08 11:42:37,015] Trial 7 finished with value: 0.2372460501615647 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:42:37,091] Trial 9 finished with value: 0.27947522472919023 and parameters: {'n_estimators': 50, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.23511049524916405.
[I 2025-09-08 11:43:06,424] Trial 8 finished with value: 0.27645274852703416 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:43:18,241] Trial 7 finished with value: 0.23968117503076786 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 6 with value: 0.22653532092544607.
[I 2025-09-08 11:43:35,252] Trial 9 finished with value: 0.2759490631820097 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:44:00,183] Trial 8 finished with value: 0.2620247515459379 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.25210378642904135.
[I 2025-09-08 11:44:44,067] Trial 9 finished with value: 0.2683896888123456 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 7 with value: 0.25210378642904135.
[I 2025-09-08 11:45:12,102] Trial 8 finished with value: 0.22651991010883266 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 8 with value: 0.22651991010883266.
[I 2025-09-08 11:45:36,392] Trial 10 finished with value: 0.23508796359682388 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.23508796359682388.
[I 2025-09-08 11:45:39,156] Trial 10 finished with value: 0.22835493525763212 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:45:45,142] Trial 10 finished with value: 0.25451090105370716 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 7 with value: 0.25210378642904135.
[I 2025-09-08 11:46:17,195] Trial 11 finished with value: 0.29662758896486763 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.25210378642904135.
[I 2025-09-08 11:47:30,139] Trial 9 finished with value: 0.2348612556872691 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 8 with value: 0.22651991010883266.
[I 2025-09-08 11:47:43,788] Trial 11 finished with value: 0.22835493525763212 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:47:48,677] Trial 12 finished with value: 0.2522642013784027 and parameters: {'n_estimators': 100, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.25210378642904135.
[I 2025-09-08 11:48:00,705] Trial 10 finished with value: 0.26018817656059773 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 8 with value: 0.22651991010883266.
[I 2025-09-08 11:48:32,641] Trial 11 finished with value: 0.22915897107020122 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 8 with value: 0.22651991010883266.
[I 2025-09-08 11:48:33,272] Trial 11 finished with value: 0.23508796359682388 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.23508796359682388.
[I 2025-09-08 11:48:49,394] Trial 12 finished with value: 0.26049272251064665 and parameters: {'n_estimators': 50, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 8 with value: 0.22651991010883266.
[I 2025-09-08 11:49:19,842] Trial 13 finished with value: 0.2522642013784027 and parameters: {'n_estimators': 100, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.25210378642904135.
[I 2025-09-08 11:49:23,566] Trial 13 finished with value: 0.22637715652618698 and parameters: {'n_estimators': 50, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 13 with value: 0.22637715652618698.
[I 2025-09-08 11:49:46,482] Trial 12 finished with value: 0.22835493525763212 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:50:21,028] Trial 13 finished with value: 0.23009789040605597 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.22835493525763212.
[I 2025-09-08 11:50:27,876] Trial 14 finished with value: 0.22316298662937997 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 14 with value: 0.22316298662937997.
[I 2025-09-08 11:50:47,138] Trial 14 finished with value: 0.25210378642904135 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 7 with value: 0.25210378642904135.
[I 2025-09-08 11:51:14,572] Trial 12 finished with value: 0.23508796359682388 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.23508796359682388.
[I 2025-09-08 11:51:40,788] Trial 14 finished with value: 0.22753901763465476 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 14 with value: 0.22753901763465476.
[I 2025-09-08 11:52:20,247] Trial 13 finished with value: 0.23508796359682388 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.23508796359682388.
[I 2025-09-08 11:53:04,283] Trial 14 finished with value: 0.23508796359682388 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.23508796359682388.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
