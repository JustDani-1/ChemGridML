Found local copy...
Loading...
Done!
[I 2025-09-08 11:30:31,491] A new study created in RDB with name: MACCS_RF_Caco2_Wang_4
[I 2025-09-08 11:30:31,513] A new study created in RDB with name: MACCS_RF_Caco2_Wang_7
[I 2025-09-08 11:30:31,534] A new study created in RDB with name: MACCS_RF_Caco2_Wang_8
[I 2025-09-08 11:30:31,913] A new study created in RDB with name: MACCS_RF_Caco2_Wang_9
[I 2025-09-08 11:30:38,078] Trial 0 finished with value: 0.24417532225636715 and parameters: {'n_estimators': 50, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.24417532225636715.
[I 2025-09-08 11:30:38,183] Trial 0 finished with value: 0.19449121589516308 and parameters: {'n_estimators': 50, 'max_depth': 20, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.19449121589516308.
[I 2025-09-08 11:30:38,238] Trial 0 finished with value: 0.24855759420432927 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.24855759420432927.
[I 2025-09-08 11:30:48,132] Trial 1 finished with value: 0.20024887620716703 and parameters: {'n_estimators': 100, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.20024887620716703.
[I 2025-09-08 11:30:48,150] Trial 1 finished with value: 0.2072525079949562 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.19449121589516308.
[I 2025-09-08 11:30:58,697] Trial 0 finished with value: 0.19630214067858948 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.19630214067858948.
[I 2025-09-08 11:31:06,271] Trial 1 finished with value: 0.18693106572888565 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.18693106572888565.
[I 2025-09-08 11:31:09,551] Trial 2 finished with value: 0.24589097958832784 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.19449121589516308.
[I 2025-09-08 11:31:14,870] Trial 2 finished with value: 0.20081242385090714 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.20024887620716703.
[I 2025-09-08 11:31:16,603] Trial 1 finished with value: 0.1979288279315532 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.19630214067858948.
[I 2025-09-08 11:31:23,968] Trial 3 finished with value: 0.19113201885167866 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:31:24,410] Trial 2 finished with value: 0.24364140229632694 and parameters: {'n_estimators': 100, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.19630214067858948.
[I 2025-09-08 11:31:31,952] Trial 2 finished with value: 0.18891165337545954 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.18693106572888565.
[I 2025-09-08 11:31:40,947] Trial 3 finished with value: 0.20064464831912082 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.20024887620716703.
[I 2025-09-08 11:31:42,092] Trial 4 finished with value: 0.24589097958832784 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:31:44,925] Trial 3 finished with value: 0.1809692294915747 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.1809692294915747.
[I 2025-09-08 11:31:45,829] Trial 4 finished with value: 0.1992391381071227 and parameters: {'n_estimators': 50, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.1992391381071227.
[I 2025-09-08 11:31:57,683] Trial 3 finished with value: 0.18450328607520647 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.18450328607520647.
[I 2025-09-08 11:31:58,470] Trial 4 finished with value: 0.23622653142351513 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.1809692294915747.
[I 2025-09-08 11:32:04,615] Trial 5 finished with value: 0.24685447780347441 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.1992391381071227.
[I 2025-09-08 11:32:09,845] Trial 5 finished with value: 0.19909959778748637 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:32:11,634] Trial 5 finished with value: 0.23622653142351513 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.1809692294915747.
[I 2025-09-08 11:32:18,707] Trial 6 finished with value: 0.24674737896862628 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 4 with value: 0.1992391381071227.
[I 2025-09-08 11:32:18,836] Trial 4 finished with value: 0.18470914217230833 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.18450328607520647.
[I 2025-09-08 11:32:29,230] Trial 6 finished with value: 0.24674877105724882 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:32:30,043] Trial 6 finished with value: 0.18944847127785158 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.1809692294915747.
[I 2025-09-08 11:32:37,120] Trial 7 finished with value: 0.24738634832906178 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 4 with value: 0.1992391381071227.
[I 2025-09-08 11:32:38,076] Trial 7 finished with value: 0.2072525079949562 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:32:42,080] Trial 7 finished with value: 0.19098718222154218 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.1809692294915747.
[I 2025-09-08 11:32:45,197] Trial 8 finished with value: 0.1962042087065701 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:32:45,247] Trial 8 finished with value: 0.2048250281360254 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 4 with value: 0.1992391381071227.
[I 2025-09-08 11:32:49,605] Trial 5 finished with value: 0.18447729089413797 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.18447729089413797.
[I 2025-09-08 11:32:56,608] Trial 9 finished with value: 0.19054721835068636 and parameters: {'n_estimators': 100, 'max_depth': 20, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 9 with value: 0.19054721835068636.
[I 2025-09-08 11:33:05,629] Trial 10 finished with value: 0.18535379729688567 and parameters: {'n_estimators': 50, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.18535379729688567.
[I 2025-09-08 11:33:09,168] Trial 6 finished with value: 0.24302125055569337 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.18447729089413797.
[I 2025-09-08 11:33:10,818] Trial 8 finished with value: 0.17837610759432948 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 8 with value: 0.17837610759432948.
[I 2025-09-08 11:33:14,622] Trial 11 finished with value: 0.18535379729688567 and parameters: {'n_estimators': 50, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.18535379729688567.
[I 2025-09-08 11:33:15,901] Trial 9 finished with value: 0.1911876941438588 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:33:23,776] Trial 12 finished with value: 0.18535379729688567 and parameters: {'n_estimators': 50, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.18535379729688567.
[I 2025-09-08 11:33:27,644] Trial 9 finished with value: 0.19401500000365157 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 8 with value: 0.17837610759432948.
[I 2025-09-08 11:33:32,693] Trial 13 finished with value: 0.18535379729688567 and parameters: {'n_estimators': 50, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.18535379729688567.
[I 2025-09-08 11:33:34,694] Trial 7 finished with value: 0.19630214067858948 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 5 with value: 0.18447729089413797.
[I 2025-09-08 11:33:36,833] Trial 10 finished with value: 0.1944224801431755 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:33:40,240] Trial 8 finished with value: 0.19302381304614485 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 5 with value: 0.18447729089413797.
[I 2025-09-08 11:33:40,335] Trial 14 finished with value: 0.18439449049573456 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 14 with value: 0.18439449049573456.
[I 2025-09-08 11:33:45,677] Trial 9 finished with value: 0.18672330520467714 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 5 with value: 0.18447729089413797.
[I 2025-09-08 11:33:50,729] Trial 11 finished with value: 0.1928212741526127 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:33:53,936] Trial 10 finished with value: 0.17766313077707668 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.17766313077707668.
[I 2025-09-08 11:33:54,533] Trial 10 finished with value: 0.1836388831833722 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 10 with value: 0.1836388831833722.
[I 2025-09-08 11:34:04,806] Trial 11 finished with value: 0.1836388831833722 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 10 with value: 0.1836388831833722.
[I 2025-09-08 11:34:06,215] Trial 12 finished with value: 0.19229052072269318 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:34:14,360] Trial 12 finished with value: 0.1836388831833722 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 10 with value: 0.1836388831833722.
[I 2025-09-08 11:34:16,518] Trial 13 finished with value: 0.19113201885167866 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:34:16,572] Trial 11 finished with value: 0.17766313077707668 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.17766313077707668.
[I 2025-09-08 11:34:24,600] Trial 13 finished with value: 0.1836388831833722 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 10 with value: 0.1836388831833722.
[I 2025-09-08 11:34:26,521] Trial 14 finished with value: 0.19113201885167866 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.19113201885167866.
[I 2025-09-08 11:34:33,248] Trial 14 finished with value: 0.19403694661880178 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 10 with value: 0.1836388831833722.
[I 2025-09-08 11:34:35,690] Trial 12 finished with value: 0.17766313077707668 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.17766313077707668.
[I 2025-09-08 11:34:44,468] Trial 13 finished with value: 0.17766313077707668 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.17766313077707668.
[I 2025-09-08 11:34:46,096] Trial 14 finished with value: 0.18456702017770765 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.17766313077707668.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
