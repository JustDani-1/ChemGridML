Found local copy...
Loading...
Done!
[I 2025-09-08 11:30:31,765] A new study created in RDB with name: RDKitFP_RF_Caco2_Wang_7
[I 2025-09-08 11:30:31,806] A new study created in RDB with name: RDKitFP_RF_Caco2_Wang_4
[I 2025-09-08 11:30:31,916] A new study created in RDB with name: RDKitFP_RF_Caco2_Wang_8
[I 2025-09-08 11:30:31,945] A new study created in RDB with name: RDKitFP_RF_Caco2_Wang_9
[I 2025-09-08 11:31:06,663] Trial 0 finished with value: 0.28214605882001903 and parameters: {'n_estimators': 50, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.28214605882001903.
[I 2025-09-08 11:31:06,898] Trial 0 finished with value: 0.2940049100819562 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.2940049100819562.
[I 2025-09-08 11:32:01,380] Trial 0 finished with value: 0.3084874342192113 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 0 with value: 0.3084874342192113.
[I 2025-09-08 11:33:33,127] Trial 0 finished with value: 0.2695798461820599 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 0 with value: 0.2695798461820599.
[I 2025-09-08 11:34:10,598] Trial 1 finished with value: 0.27499461228672023 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.27499461228672023.
[I 2025-09-08 11:35:34,961] Trial 1 finished with value: 0.28156783374274935 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.2695798461820599.
[I 2025-09-08 11:36:40,645] Trial 2 finished with value: 0.28330159216752415 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 0 with value: 0.2695798461820599.
[I 2025-09-08 11:37:24,258] Trial 2 finished with value: 0.27325759243091086 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 2 with value: 0.27325759243091086.
[I 2025-09-08 11:37:33,485] Trial 1 finished with value: 0.2756487929773491 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:37:37,991] Trial 1 finished with value: 0.27422838509178776 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:38:10,903] Trial 2 finished with value: 0.28572662338245913 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:39:39,850] Trial 3 finished with value: 0.2694327665043428 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:40:32,393] Trial 3 finished with value: 0.27325759243091086 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 2 with value: 0.27325759243091086.
[I 2025-09-08 11:40:48,861] Trial 2 finished with value: 0.2860547072878252 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:41:05,231] Trial 3 finished with value: 0.2872700286026184 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:41:05,531] Trial 4 finished with value: 0.28571779395938096 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 2 with value: 0.27325759243091086.
[I 2025-09-08 11:41:40,132] Trial 5 finished with value: 0.28655275862471213 and parameters: {'n_estimators': 50, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 2 with value: 0.27325759243091086.
[I 2025-09-08 11:42:06,602] Trial 4 finished with value: 0.28390559393218656 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:42:32,119] Trial 5 finished with value: 0.32619308507734474 and parameters: {'n_estimators': 50, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:42:47,826] Trial 4 finished with value: 0.27666890236418357 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:42:53,808] Trial 3 finished with value: 0.28773467257560525 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:43:55,993] Trial 5 finished with value: 0.2818504935689227 and parameters: {'n_estimators': 50, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:45:05,515] Trial 4 finished with value: 0.2798111242075766 and parameters: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:45:23,643] Trial 6 finished with value: 0.2754830353609464 and parameters: {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:45:57,735] Trial 6 finished with value: 0.2653904936124579 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 11:46:09,109] Trial 6 finished with value: 0.2744566130200663 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:46:29,157] Trial 5 finished with value: 0.2839347820758688 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:47:27,060] Trial 7 finished with value: 0.30897741923735633 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 11:47:34,022] Trial 6 finished with value: 0.2889113096889496 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:48:33,332] Trial 8 finished with value: 0.2786502098979233 and parameters: {'n_estimators': 100, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 11:48:38,942] Trial 7 finished with value: 0.2889095025354238 and parameters: {'n_estimators': 100, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:48:56,476] Trial 7 finished with value: 0.27104500044228164 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:49:33,911] Trial 7 finished with value: 0.2755830893973563 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:51:31,897] Trial 8 finished with value: 0.2805431026526704 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:51:41,045] Trial 9 finished with value: 0.27407112561754715 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 11:51:43,681] Trial 8 finished with value: 0.2711386273851731 and parameters: {'n_estimators': 200, 'max_depth': None, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:52:43,092] Trial 9 finished with value: 0.2829465527223222 and parameters: {'n_estimators': 50, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:52:43,137] Trial 8 finished with value: 0.2835084458898205 and parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 5, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:53:03,990] Trial 10 finished with value: 0.27088258767060247 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 11:53:42,684] Trial 9 finished with value: 0.2848127101020267 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 10, 'min_samples_leaf': 4}. Best is trial 1 with value: 0.27422838509178776.
[I 2025-09-08 11:54:25,355] Trial 11 finished with value: 0.27088258767060247 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 11:55:47,207] Trial 12 finished with value: 0.27088258767060247 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 11:55:55,856] Trial 10 finished with value: 0.27744150724598876 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:57:08,233] Trial 13 finished with value: 0.27088258767060247 and parameters: {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 11:57:26,670] Trial 11 finished with value: 0.31358013569340504 and parameters: {'n_estimators': 200, 'max_depth': 5, 'min_samples_split': 5, 'min_samples_leaf': 1}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 11:58:00,662] Trial 9 finished with value: 0.27666645434537523 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 11:58:01,343] Trial 10 finished with value: 0.27404226897618456 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.27404226897618456.
[I 2025-09-08 12:00:27,728] Trial 12 finished with value: 0.2694327665043428 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 12:01:04,290] Trial 14 finished with value: 0.26574498835873095 and parameters: {'n_estimators': 300, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}. Best is trial 6 with value: 0.2653904936124579.
[I 2025-09-08 12:02:16,710] Trial 11 finished with value: 0.27404226897618456 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.27404226897618456.
[I 2025-09-08 12:02:18,574] Trial 10 finished with value: 0.27860149581267984 and parameters: {'n_estimators': 300, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 12:03:05,331] Trial 13 finished with value: 0.2694327665043428 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 12:03:59,129] Trial 11 finished with value: 0.32271836744518806 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 12:05:23,065] Trial 14 finished with value: 0.2694327665043428 and parameters: {'n_estimators': 200, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 2}. Best is trial 3 with value: 0.2694327665043428.
[I 2025-09-08 12:05:33,064] Trial 12 finished with value: 0.27404226897618456 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.27404226897618456.
[I 2025-09-08 12:07:53,727] Trial 13 finished with value: 0.27404226897618456 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.27404226897618456.
[I 2025-09-08 12:07:53,943] Trial 12 finished with value: 0.27666645434537523 and parameters: {'n_estimators': 300, 'max_depth': 20, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 12:08:59,605] Trial 13 finished with value: 0.32271836744518806 and parameters: {'n_estimators': 300, 'max_depth': 5, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 12:09:17,290] Trial 14 finished with value: 0.29372240511558206 and parameters: {'n_estimators': 50, 'max_depth': None, 'min_samples_split': 10, 'min_samples_leaf': 1}. Best is trial 1 with value: 0.2756487929773491.
[I 2025-09-08 12:10:02,346] Trial 14 finished with value: 0.27404226897618456 and parameters: {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2, 'min_samples_leaf': 1}. Best is trial 10 with value: 0.27404226897618456.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table studies already exists

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 243, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 96, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 72, in run_hyperparameter_optimization
    study = optuna.create_study(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/_convert_positional_args.py", line 135, in converter_wrapper
    return func(**kwargs)  # type: ignore[call-arg]
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 1297, in create_study
    storage = storages.get_storage(storage)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/__init__.py", line 49, in get_storage
    return _CachedStorage(RDBStorage(storage))
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py", line 238, in __init__
    models.BaseModel.metadata.create_all(self.engine)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 4889, in create_all
    bind._run_ddl_visitor(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3147, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2130, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 851, in visit_metadata
    self.traverse_single(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 895, in visit_table
    self.connection.execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1398, in _execute_ddl
    ret = self._execute_context(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 130, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 438, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 390, in __get_result
    raise self._exception
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table studies already exists
[SQL: 
CREATE TABLE studies (
	study_id INTEGER NOT NULL, 
	study_name VARCHAR(512) NOT NULL, 
	PRIMARY KEY (study_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
