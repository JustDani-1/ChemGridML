No normalization for SPS. Feature removed!
No normalization for AvgIpc. Feature removed!
No normalization for NumAmideBonds. Feature removed!
No normalization for NumAtomStereoCenters. Feature removed!
No normalization for NumBridgeheadAtoms. Feature removed!
No normalization for NumHeterocycles. Feature removed!
No normalization for NumSpiroAtoms. Feature removed!
No normalization for NumUnspecifiedAtomStereoCenters. Feature removed!
No normalization for Phi. Feature removed!
2025-09-09 14:02:45.939128: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-09-09 14:02:45.994100: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:tensorflow:From /home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/tensorflow/python/util/deprecation.py:588: calling function (from tensorflow.python.eager.polymorphic_function.polymorphic_function) with experimental_relax_shapes is deprecated and will be removed in a future version.
Instructions for updating:
experimental_relax_shapes is deprecated, use reduce_retracing instead
Skipped loading modules with transformers dependency. No module named 'transformers'
cannot import name 'HuggingFaceModel' from 'deepchem.models.torch_models' (/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/deepchem/models/torch_models/__init__.py)
Found local copy...
Loading...
Done!
[14:03:03] WARNING: not removing hydrogen atom without neighbors
[14:03:03] WARNING: not removing hydrogen atom without neighbors
[14:03:03] WARNING: not removing hydrogen atom without neighbors
[14:03:03] WARNING: not removing hydrogen atom without neighbors
[14:03:03] WARNING: not removing hydrogen atom without neighbors
[14:03:03] WARNING: not removing hydrogen atom without neighbors
[14:03:03] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[14:03:04] WARNING: not removing hydrogen atom without neighbors
[I 2025-09-09 14:03:54,564] A new study created in RDB with name: __init__
[I 2025-09-09 14:03:54,837] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_0
[I 2025-09-09 14:03:54,896] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_1
[I 2025-09-09 14:03:54,980] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_2
[I 2025-09-09 14:03:55,060] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_3
[W 2025-09-09 14:07:37,726] Trial 0 failed with parameters: {'n_neighbors': 5, 'weights': 'distance', 'metric': 'chebyshev', 'epochs': 50, 'lr': 0.0027205205383416136, 'batch_size': 32} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:07:37,749] Trial 0 failed with value None.
[I 2025-09-09 14:07:38,396] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_4
[W 2025-09-09 14:08:34,734] Trial 0 failed with parameters: {'n_neighbors': 5, 'weights': 'distance', 'metric': 'minkowski', 'epochs': 50, 'lr': 0.007709772432408438, 'batch_size': 16} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:08:34,737] Trial 0 failed with value None.
[I 2025-09-09 14:08:35,180] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_5
[W 2025-09-09 14:08:42,847] Trial 0 failed with parameters: {'n_neighbors': 3, 'weights': 'uniform', 'metric': 'minkowski', 'epochs': 50, 'lr': 1.954646219795182e-05, 'batch_size': 64} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:08:42,848] Trial 0 failed with value None.
[I 2025-09-09 14:08:43,276] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_6
[W 2025-09-09 14:13:31,437] Trial 0 failed with parameters: {'n_neighbors': 9, 'weights': 'distance', 'metric': 'minkowski', 'epochs': 50, 'lr': 2.6850064899040815e-05, 'batch_size': 16} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:13:31,438] Trial 0 failed with value None.
[I 2025-09-09 14:13:31,602] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_7
[W 2025-09-09 14:15:06,611] Trial 0 failed with parameters: {'n_neighbors': 5, 'weights': 'distance', 'metric': 'minkowski', 'epochs': 50, 'lr': 0.005479215858832782, 'batch_size': 16} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:15:06,612] Trial 0 failed with value None.
[I 2025-09-09 14:15:06,772] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_8
[W 2025-09-09 14:17:42,846] Trial 0 failed with parameters: {'n_neighbors': 5, 'weights': 'distance', 'metric': 'chebyshev', 'epochs': 150, 'lr': 0.0075817735316871145, 'batch_size': 16} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:17:42,847] Trial 0 failed with value None.
[I 2025-09-09 14:17:43,023] A new study created in RDB with name: GRAPH_GAT_BBB_Martins_9
[W 2025-09-09 14:21:20,079] Trial 0 failed with parameters: {'n_neighbors': 11, 'weights': 'uniform', 'metric': 'minkowski', 'epochs': 150, 'lr': 1.5883584992459012e-05, 'batch_size': 16} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:21:20,080] Trial 0 failed with value None.
[W 2025-09-09 14:23:39,331] Trial 0 failed with parameters: {'n_neighbors': 5, 'weights': 'uniform', 'metric': 'minkowski', 'epochs': 100, 'lr': 8.181424366562347e-05, 'batch_size': 64} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:23:39,331] Trial 0 failed with value None.
[W 2025-09-09 14:24:47,886] Trial 0 failed with parameters: {'n_neighbors': 11, 'weights': 'distance', 'metric': 'manhattan', 'epochs': 100, 'lr': 0.00021036783465162926, 'batch_size': 32} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:24:47,886] Trial 0 failed with value None.
[W 2025-09-09 14:25:24,968] Trial 0 failed with parameters: {'n_neighbors': 5, 'weights': 'uniform', 'metric': 'manhattan', 'epochs': 150, 'lr': 0.0003887207761443172, 'batch_size': 32} because of the following error: ValueError('shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)').
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
[W 2025-09-09 14:25:24,968] Trial 0 failed with value None.
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/process.py", line 246, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 101, in run_single_experiment
    best_hyperparams = self.run_hyperparameter_optimization(
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 89, in run_hyperparameter_optimization
    study.optimize(objective, n_trials=env.N_TRIALS)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 86, in objective
    cv_predictions = self.kfold_cv(X, Y, model_name, task_type, hyperparams)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 53, in kfold_cv
    predictions[val_idx] = fold_predictions
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/./code/main.py", line 18, in <module>
    manager.run_nested_cv(fingerprint, model_name, dataset_name)
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 140, in run_nested_cv
    raise exc
  File "/myriadfs/home/ucnwdma/Scratch/UCL_internship/code/study_manager.py", line 135, in run_nested_cv
    seed_result, test_predictions, test_indices = future.result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/home/ucnwdma/miniconda3/envs/internship/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
ValueError: shape mismatch: value array of shape (650,) could not be broadcast to indexing result of shape (325,)
